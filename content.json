{"meta":{"title":"Coding Life.log","subtitle":"Yesterday you say tomorrow","description":"","author":"antisamael","url":"http://yoursite.com","root":"/"},"pages":[],"posts":[{"title":"使用Pandas处理Excel操作总结","slug":"使用Pandas处理Excel操作总结","date":"2020-05-16T14:47:35.000Z","updated":"2020-05-16T17:26:34.070Z","comments":true,"path":"2020/05/16/使用Pandas处理Excel操作总结/","link":"","permalink":"http://yoursite.com/2020/05/16/%E4%BD%BF%E7%94%A8Pandas%E5%A4%84%E7%90%86Excel%E6%93%8D%E4%BD%9C%E6%80%BB%E7%BB%93/","excerpt":"","text":"去年年底从开发岗转到维护岗后，工作中需要处理大量的 Excel 表格，由于之前做开发的时候很少接触 Excel，对于它的认知也就是会使用 SUM 这些简单的公式，VBA 更是没有接触过了，面对大量的 Excel 文档和他们动辄几万行的数据，人工处理实在是太浪费时间了，还好之前自学过一点 Python，于是便开始了自我救赎之旅。 研究了几个可以用于处理 Excel 的模块之后，我最终选择了 Pandas 和 openpyxl Pandas 主要用来处理数据，openpyxl 用于处理样式和保存文档。 这里只记录一下工作过程中经常用到的几个方法。 读取 Excel 文件读取 Excel 文件的方法是 read_excel() 123import pandas as pdfd = pd.read_excel(\"Workbook.xlsx\", \"SheetX\")print(fd) 第一个参数填写 Excel 文件的路径，第二个参数填写需要打开的标签页；第二个参数如果不填，则默认打开第一个标签页。 保存 Excel 文件保存 Excel 文件的方法方式 to_excel() 1fd.to_excel(\"Workbook_copy.xlsx\") 需要注意的是，保存的excel是不带样式的，所以我一般只用它来做测试查看结果是否符合预期，要输出可以交付的文档的时候，一般使用都是先使用 pandas 得到想要的数据，然后使用 openpyxl 保存。 另外，默认的保存方式得到的 Excel 表格是带有 index （可以理解为原始数据的行号，不过是以 0 开头）和 header （列标），如果不需要它，那么再后面加上参数 index=None 和 header=None 即可。 1fd.to_excel(\"Workbook_copy.xlsx, index=None, header=None\") 选取单元格内容loc 和 iloc 读取一行 1fd.loc(1, :) 读取一列 12fd['列标签1'] # 通常的做法fd.loc(:, ['列标签1']) # 还可以这么做 读取一行一列 12fd.loc[3,['列标签1']] # orfd.iloc[3, 1] 读取多行多列 12fd.loc[[1, 3, 5], ['列标签1', '列标签2']] # orfd.iloc[[1, 3, 5], [1, 2]] 读取某列所有元素1vals = fd.loc('列标签').to_list() 筛选比如我们的表格中有一列的索引名称为“是否安装”，想选取值为 N 的数据： 1data_y = data[data['是否安装'] == 'N'] 使用 &amp; 和 | 可以使用更多的筛选条件，比如： 1data_y = data[(data['是否安装'] == 'Y') &amp; (data['用途'] == '效率')] 对于更复杂的筛选条件，使用 apply ，先用简单的例子来说明一下，比如还是上文的选取索引值名称为“是否安装”里面 N 的数据： 1234def IsInstalled(val): return val == 'Ndata_y = data[data['是否安装'].apply(IsInstalle)] 当然可以带有参数，更为灵活 1234def IsInstalledArgs(val, is_install): return val == is_installdata_y = data[data['是否安装'].apply(IsInstalledArgs, args=('N',))] 统计123df.shape # 返回数据的行列df.count # 返回每一列中非空值的个数len(df['Column'].index.values) # 数据的条数 修改1df[3, '列标签'] = '一个新值'","categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/tags/Python/"}]},{"title":"Hello World","slug":"hello-world","date":"2020-03-20T17:19:56.000Z","updated":"2020-03-23T16:16:01.334Z","comments":true,"path":"2020/03/21/hello-world/","link":"","permalink":"http://yoursite.com/2020/03/21/hello-world/","excerpt":"","text":"你好，这是我的第一篇个人博客，主要记录一些软件工程，编码的心得，还有相关工具使用方法。 12345678#include &lt;iostream&gt;using namespace std;int main()&#123; cout &lt;&lt; \"Hello,world!\" &lt;&lt; endl; return 0;&#125;","categories":[],"tags":[{"name":"misc","slug":"misc","permalink":"http://yoursite.com/tags/misc/"}]}],"categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/tags/Python/"},{"name":"misc","slug":"misc","permalink":"http://yoursite.com/tags/misc/"}]}